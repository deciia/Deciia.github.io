{"title":"白幽灵笔记（一）","slug":"game/White-Ghost-Notes-01","date":"2014-12-06T01:22:25.000Z","updated":"2017-05-12T06:15:18.795Z","comments":true,"path":"api/articles/game/White-Ghost-Notes-01.json","photos":[],"link":"","excerpt":"11月初看到Gamamaker群（QQ群235271204）小太的白吃黑小游戏，迸发出一个灵感，可以吃猫捉老鼠一样的游戏。小太的游戏：http://tieba.baidu.com/p/3372537902。<br>Gamemaker论坛该开发日志同步更新：http://www.gamemaker.cn/forum.php?mod=viewthread&amp;tid=703","covers":null,"content":"<blockquote>\n<p><strong><em>11月初</em></strong></p>\n</blockquote>\n<p>看到Gamamaker群（QQ群<strong>235271204</strong>）小太的白吃黑小游戏，迸发出一个灵感，可以吃猫捉老鼠一样的游戏。小太的游戏：<a href=\"http://tieba.baidu.com/p/3372537902。\" target=\"_blank\" rel=\"external\">http://tieba.baidu.com/p/3372537902。</a><br>Gamemaker论坛该开发日志同步更新：<a href=\"http://www.gamemaker.cn/forum.php?mod=viewthread&amp;tid=703\" target=\"_blank\" rel=\"external\">http://www.gamemaker.cn/forum.php?mod=viewthread&amp;tid=703</a></p>\n<a id=\"more\"></a>\n<h2 id=\"白吃黑AI实现\"><a href=\"#白吃黑AI实现\" class=\"headerlink\" title=\"白吃黑AI实现\"></a>白吃黑AI实现</h2><p>然后建了项目，一开始把AI建好了，白色圆点是主角，黑点是NPC或者怪物，控制白点去吃黑点，黑点感知白点的位置会逃走。但是光点是吃黑点并没有什么意思，这就是小太的创意的核心了，包围白点的是黑色的圆圈，吃黑点的过程中，黑圈会慢慢的变大，最后覆盖住整个屏幕，这个过程的实现很简单。接下来是增加BOSS守卫进化的黑幽灵。当包围白点的黑圈到了一定大小守卫便会出现，守卫也会吃黑点变大，相反，包围它的是白色的圆圈，如果白圈大过黑圈就会反过来吃主角。</p>\n<p>然后是玩法的设计，我的定位是<strong>RPG+策略+动作</strong>，RPG体现在故事情节上，策略则通物场景中的建筑物来实现，设计几个建筑，对角色的速度，黑圈的增长速度，大小进行控制，动作则是体现在角色会根据运动的路径发出指定的指令，也就是用舞蹈的不同代表不同的技能，之后会对数值进行微调，增加动作的爽快度。之后还得有故事，我设计一个白幽灵旅行到了幽灵村的故事..绘制场景，设计主角都是根据故事来的,主角用曲线绘制，场景用了俯视的假3D。</p>\n<p>在考虑建筑作为“阵”的同时，启动阵的特效方面，决定采用粒子，但试验了一下，发现单独用粒子，并不能达到我要的效果，然后便进行了光影系统的设计，把建筑物和粒子都纳入到光影中，场景的表现则更为完美。</p>\n<blockquote>\n<p><strong><em>11月26日</em></strong></p>\n</blockquote>\n<p>##俯视3D光影的实现</p>\n<p>俯视3D的光影系统主要考虑光与建筑物的高度：</p>\n<ul>\n<li>如果光在建筑物的上面，首先是绘制建筑物的上表面 其次绘制建筑物的投影，再次投影是放大的与建筑物等形的黑影。</li>\n<li>如果光与建筑物等高，则不绘制建筑物的上表面 ，且给制建筑物的切线阴影，所谓切线阴影是指由光源出发的光线作为建筑物的切线，建筑物背对光源的阴影便在两条切线之间。</li>\n<li>如果光在建筑物的下面，则考虑建筑物下面的漫反射，建筑物的外边界会有比较明显的光晕。</li>\n</ul>\n<p>关于切线阴影的切角，除于常规的通过建筑物的切半径，与建筑物、光源两点的距离进行计算，</p>\n<pre><code>dir = darccos(r/point_distance(bx,by,sx,sy))\n</code></pre><p>还有一种更简单的方式就是通过精确碰撞来实现，假设光线由逐渐延长的光线段组成，在光线段与建筑物发生碰撞的时候，用高级绘图函数记录下轮廓，这种方式要用到精确碰撞，不适合过于复杂的建筑物，而且场景中建筑物的数量一多，游戏速度将很慢。</p>\n<blockquote>\n<p>修复光在障碍物的正上方，没有投影的bug 已解决<br>修复投影不是纯黑而是精灵图片的bug<br>修复射线阴影在障碍物表面阴影切线位置留下明显边际的bug<br>以下功能需要实现：<br>光在障碍物的正下方，绘制光晕。<br>扇形光的绘制<br>给投影添加模糊的边界，因为即使是点光源，也是有一定面积的<br>测试粒子系统与光影系统的结合</p>\n</blockquote>\n<p>在绘制阴影的时，多边形投影目前是采用精灵+混合模式+表面的模式，当主角在建筑物的上面，，越来越靠近建筑物时，会在地面上投影比较大的阴影，可以看到明显的锯齿，需要对锯齿进行模糊处理，通常采用的模糊方法有两种：</p>\n<ul>\n<li>第一种是叠加不同透明度的精灵，精灵做一定的旋转或移位</li>\n<li>第二种是将精灵绘制到表面，对表面进行移位和透明度的处理</li>\n</ul>\n<p>这两种办法都会遇到一个问题，，场景中要绘制阴影的实例比较多的时候，会有明显的降速，接下来会尝试shade的模糊效果。看了<a href=\"http://mizukiyo.ys168.com/\" title=\"静谷幽兰\" target=\"_blank\" rel=\"external\">Tifaices的空间</a>发现了一些有趣的东西，阴影的绘制方法也有了新的思路,比如使用另外一个模糊的图片。</p>\n<blockquote>\n<p><strong><em>11月30日</em></strong></p>\n</blockquote>\n<p>光影系统已经完成，，准备用shade进行优化，正在学习shader的相关知识，了解到shader使用时需要用到的一门比较有用的语言GLSL<br><a href=\"http://pan.baidu.com/s/1kT42faR\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1kT42faR</a><br><a href=\"https://github.com/h3rb/gml-pro\" target=\"_blank\" rel=\"external\">gml-pro</a><br><a href=\"http://gmc.yoyogames.com/index.php?s=0d0e2ecd4192cd0c9aeebf6bcc98c2ac&amp;showforum=136\" target=\"_blank\" rel=\"external\">GMS shade专区</a></p>\n","categories":[{"name":"游戏","slug":"游戏","count":11,"path":"api/categories/游戏.json"}],"tags":[{"name":"开发笔记","slug":"开发笔记","count":3,"path":"api/tags/开发笔记.json"}]}